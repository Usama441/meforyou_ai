<main class="chat-wrapper">
  <div class="chat-box">
    <div class="chat-header">
      <h1>MeForYou.AI</h1>
      <div class="theme-toggle">
        <label class="switch">
          <input type="checkbox" id="darkModeToggle">
          <span class="slider round"></span>
        </label>
      </div>
    </div>

    <p class="greeting">
      Hello <%= current_user.relationship.present? ? current_user.relationship.capitalize : "there" %>, ask something to your AI companion:
    </p>

    <% if @chats.present? %>
      <div class="chat-history" id="chatHistory">
        <% @chats.each do |chat| %>
          <div class="chat-bubble user">
            <div class="avatar">ðŸ‘¤</div>
            <div>
              <p><strong>You:</strong> <%= chat.message %></p>
              <span class="timestamp"><%= chat.created_at.strftime("%H:%M") %></span>
            </div>
          </div>
          <div class="chat-bubble bot">
            <div class="avatar">ðŸ¤–</div>
            <div>
              <p><strong>AI:</strong> <%= chat.reply %></p>
              <span class="timestamp"><%= chat.updated_at.strftime("%H:%M") %></span>
            </div>
          </div>
        <% end %>
      </div>
    <% end %>

    <%= form_with url: chat_path, method: :post, local: true, class: "chat-form" do %>
      <div class="emoji-input-wrapper">
        <%= text_field_tag :message, nil, placeholder: "Type your message...", class: "chat-input", id: "chatInput", autocomplete: "off" %>
        <button type="button" id="emojiBtn" class="emoji-btn">ðŸ˜Š</button>
        <%= submit_tag "Send", class: "chat-send" %>
      </div>
      <div id="emojiPicker" class="emoji-picker"></div>
    <% end %>
  </div>
</main>
